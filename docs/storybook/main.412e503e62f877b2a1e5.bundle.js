(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1309:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(896);module._StorybookPreserveDecorators=!0,Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)([__webpack_require__(1504)],module)}.call(this,__webpack_require__(708)(module))},1504:function(module,exports,__webpack_require__){var map={"./components/Example/Example.stories.js":1751};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=1504},1630:function(module,exports){},1645:function(module,exports){},1646:function(module,exports){},1657:function(module,exports){},1658:function(module,exports){},1666:function(module,exports){},1673:function(module,exports){},1681:function(module,exports){},1682:function(module,exports){},1691:function(module,exports){},1699:function(module,exports){},1700:function(module,exports){},1708:function(module,exports){},1716:function(module,exports){},1717:function(module,exports){},1739:function(module,exports){},1751:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Empty",(function(){return Empty})),__webpack_require__.d(__webpack_exports__,"Unlocked",(function(){return Unlocked})),__webpack_require__.d(__webpack_exports__,"Locked",(function(){return Locked}));__webpack_require__(214);var regenerator=__webpack_require__(202),regenerator_default=__webpack_require__.n(regenerator),asyncToGenerator=(__webpack_require__(323),__webpack_require__(426)),slicedToArray=__webpack_require__(906),react=__webpack_require__(0),react_default=__webpack_require__.n(react),dist=__webpack_require__(897),universal_wallet_esm=__webpack_require__(251),Default=(__webpack_exports__.default={title:"Universal Wallet"},function(props){var _React$useState=react_default.a.useState({status:props.status,contents:props.contents}),_React$useState2=Object(slicedToArray.a)(_React$useState,2),walletState=_React$useState2[0],setWalletState=_React$useState2[1],toggleLockStatus=function(){var _ref2=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee(_ref){var status,password,contents,wallet;return regenerator_default.a.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(status=_ref.status,password=_ref.password,contents=_ref.contents,console.log("toggleLockStatus",{status:status,password:password,contents:contents}),(wallet=new universal_wallet_esm.a(contents)).status=status,"LOCKED"!==status){_context.next=7;break}return _context.next=7,wallet.unlock(password);case 7:if("UNLOCKED"!==status){_context.next=10;break}return _context.next=10,wallet.lock(password);case 10:setWalletState({status:wallet.status,contents:wallet.contents});case 11:case"end":return _context.stop()}}),_callee)})));return function(){return _ref2.apply(this,arguments)}}(),importWallet=function(){var _ref3=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee2(encryptedWallet){var wallet;return regenerator_default.a.wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return console.log("importWallet",encryptedWallet),wallet=new universal_wallet_esm.a,_context2.next=4,wallet.import(encryptedWallet);case 4:setWalletState({status:wallet.status,contents:wallet.contents});case 5:case"end":return _context2.stop()}}),_callee2)})));return function(){return _ref3.apply(this,arguments)}}(),generateWallet=function(){var _ref4=Object(asyncToGenerator.a)(regenerator_default.a.mark((function _callee3(){var seed,wallet;return regenerator_default.a.wrap((function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return console.log("generateWallet"),"storybook",_context3.next=4,universal_wallet_esm.a.passwordToSeed("storybook");case 4:return seed=_context3.sent,_context3.next=7,universal_wallet_esm.a.generate(seed);case 7:wallet=_context3.sent,setWalletState({status:wallet.status,contents:wallet.contents});case 9:case"end":return _context3.stop()}}),_callee3)})));return function(){return _ref4.apply(this,arguments)}}();return react_default.a.createElement("div",null,react_default.a.createElement(dist.UniversalWallet,Object.assign({walletState:walletState,image:"https://www.transmute.industries/svg/Logo-Transmute-icon-Purp.svg",importWallet:importWallet,exportWallet:function exportWallet(status,contents){if(console.log("exportWallet",status,contents),"LOCKED"!==status)throw new Error("Cannot export unlocked wallet.");var wallet=new universal_wallet_esm.a(contents);return wallet.status=status,wallet.export()},toggleLockStatus:toggleLockStatus,saveWallet:function saveWallet(contents){console.log("saveWallet",contents),setWalletState({contents:contents})},deleteWallet:function deleteWallet(){console.log("deleteWallet"),setWalletState({status:"UNLOCKED",contents:[]})},generateWallet:generateWallet},props)))});Default.displayName="Default";var Empty=function(){return react_default.a.createElement(Default,{status:"UNLOCKED",contents:[]})};Empty.displayName="Empty";var _ref5=react_default.a.createElement(Default,{status:"UNLOCKED",contents:[{id:"urn:digest:d3288f0d87f58b50c5eeb8979e15fc8ce684a36ae6c360f593cde69159d6743c",title:"My Entropy",image:"https://via.placeholder.com/150",description:"For testing only.",tags:["inception"],correlation:["urn:digest:d3288f0d87f58b50c5eeb8979e15fc8ce684a36ae6c360f593cde69159d6743c"],type:"Entropy",seed:"712645d49e11c871c17ed149a48e0c3cdb24ecebfcf5ef885d1d8c078d4fcc24"},{id:"did:key:z6Mkn28V7Mk7TyvS82GH5CByFWgBeTbtUedc3HDvJz4bta5f#z6Mkn28V7Mk7TyvS82GH5CByFWgBeTbtUedc3HDvJz4bta5f",type:"Ed25519VerificationKey2018",controller:["did:key:z6Mkn28V7Mk7TyvS82GH5CByFWgBeTbtUedc3HDvJz4bta5f#z6Mkn28V7Mk7TyvS82GH5CByFWgBeTbtUedc3HDvJz4bta5f"],publicKeyBase58:"8ZsSX7Vg8SRy1XRaPdE8QR8BptL34mPFMGJzUi6ayMJH",privateKeyBase58:"3GD7Tf1LVyyeFTDGyKN965Uxv4URGpqXf1zatENh8KD4nhhxnpSAHrXFt8gSK7ef1qLtyeQNutW1znAVGhFb7wC5",title:"My Signing Key",image:"https://via.placeholder.com/150",description:"Generated from seed.",tags:["inception"],correlation:["urn:digest:d3288f0d87f58b50c5eeb8979e15fc8ce684a36ae6c360f593cde69159d6743c"]},{id:"did:key:z6Mkn28V7Mk7TyvS82GH5CByFWgBeTbtUedc3HDvJz4bta5f#z6LSnyFDbNfnxgA9MjPwxubimEn2HeDz82kcTgy5XviPUzMU",type:"X25519KeyAgreementKey2019",controller:["did:key:z6Mkn28V7Mk7TyvS82GH5CByFWgBeTbtUedc3HDvJz4bta5f#z6LSnyFDbNfnxgA9MjPwxubimEn2HeDz82kcTgy5XviPUzMU"],publicKeyBase58:"CJ5454rvsDSQGM2BSG5mSeZYSVgsRRaTaiFQ3U4rmcai",privateKeyBase58:"Dw9WeBXLdBPr5wLVkPNAaTeC5vMhouJqngHrsyTNnXjN",title:"My Encryption Key",image:"https://via.placeholder.com/150",description:"Generated from seed.",tags:["inception"],correlation:["urn:digest:d3288f0d87f58b50c5eeb8979e15fc8ce684a36ae6c360f593cde69159d6743c"]}]}),Unlocked=function(){return _ref5};Unlocked.displayName="Unlocked";var _ref6=react_default.a.createElement(Default,{status:"LOCKED",contents:[{id:"urn:digest:d3288f0d87f58b50c5eeb8979e15fc8ce684a36ae6c360f593cde69159d6743c",jwe:{protected:"eyJlbmMiOiJYQzIwUCJ9",recipients:[{header:{kid:"did:key:z6Mkf7FWHfJANm9n4hPMt3dmtAcqnkNuyJLHSovSMnfq4Wws#z6LSpndE8VEdX3kBMMFNnBjvha2ZypXxhBZCfW7qeojX2V6J",alg:"ECDH-ES+A256KW",epk:{kty:"OKP",crv:"X25519",x:"FgUN-lPYL532zuTV1qdiv39c9fL4MQkCaP0LlzB222o"},apu:"FgUN-lPYL532zuTV1qdiv39c9fL4MQkCaP0LlzB222o",apv:"ZGlkOmtleTp6Nk1rZjdGV0hmSkFObTluNGhQTXQzZG10QWNxbmtOdXlKTEhTb3ZTTW5mcTRXd3MjejZMU3BuZEU4VkVkWDNrQk1NRk5uQmp2aGEyWnlwWHhoQlpDZlc3cWVvalgyVjZK"},encrypted_key:"DkGWJZBTgzimoveBnB8NCW9aEDTQfDyy6f4oTMFY6BmlCXhutPznLw"}],iv:"f7giHN0QzPoBU-5BOmzS3zN0JbIm9vhx",ciphertext:"oOBUBCm7ybRRNw9iZjUIF8W6EpLz5PxF4I07AcD2SMJbwtCN4cWdh2SM-kmEqGqT55v4wZE6PcLsTeiZ15caRmK8IXwH_yaB2PV13uzZJT_FvepREavJBJd9Fd-sLLur1ffcrgUDcyB_YnoS-sw2JBkrRbxBx0yQ321EjtnpIy2WtwTBvUb4Av0UxZtzI5tP8WFbO1J-FpUhmd7DvwWMvAXOjIaBk69iBbbQ1aHO8BRQ5D-3LNEBdxyePx-wNLwByZMQrD0f27jVAa--h8BuTsvzqWe1-rBhyfc8kykzbCpmqYf7rY8odyCOR0N762DwKgvB4GOTZNaJ8n_dC7tP7f1DIcf5HLk-n7mzX-CHIUez55AnrgIuLsBFdlNNOtIoF6N4gzscq-ZRkOQmsISWe9FNZqNsypc8EV5i4tjQi7ByqniPjgEdgdrW7GtNHYe1KTFFjmivjaiOQMIelorhCGZiJL7lhTv_wr1TsoGG1GQt3k_s_-6LZfvGao3UAvVohu3a",tag:"QFTODSot08yIp29ONRuDoA"}},{id:"did:key:z6Mkn28V7Mk7TyvS82GH5CByFWgBeTbtUedc3HDvJz4bta5f#z6Mkn28V7Mk7TyvS82GH5CByFWgBeTbtUedc3HDvJz4bta5f",jwe:{protected:"eyJlbmMiOiJYQzIwUCJ9",recipients:[{header:{kid:"did:key:z6Mkf7FWHfJANm9n4hPMt3dmtAcqnkNuyJLHSovSMnfq4Wws#z6LSpndE8VEdX3kBMMFNnBjvha2ZypXxhBZCfW7qeojX2V6J",alg:"ECDH-ES+A256KW",epk:{kty:"OKP",crv:"X25519",x:"6ykSeNz_II136iSrD-myFJ7CuIol9tlrm9FyWGKyS2w"},apu:"6ykSeNz_II136iSrD-myFJ7CuIol9tlrm9FyWGKyS2w",apv:"ZGlkOmtleTp6Nk1rZjdGV0hmSkFObTluNGhQTXQzZG10QWNxbmtOdXlKTEhTb3ZTTW5mcTRXd3MjejZMU3BuZEU4VkVkWDNrQk1NRk5uQmp2aGEyWnlwWHhoQlpDZlc3cWVvalgyVjZK"},encrypted_key:"OXYQKiPs4MLjgNtguQ8OpQVN8VRPnaqW_M0mSHUWcBbkz0Z39lOYlw"}],iv:"PyRRaIRSXort2EJsJoMqbEreiY_pIKeB",ciphertext:"pT-q9MvpkBzvC9DLr7byBspVvJXgmCQEaB4tFCioiD6HHlAoyNjPDgek8MKulBzOFpRECo5YGKZhC2FWbhmrsL2S4_wmnB2vOjqud5QkbNZDEX4lB1RaKvjpjC_IGspfOCqw_ap9D5xTrkwucJl01i2JmPx878b4JXjcm7icf1mYz3cm-TjBkTo-_eXuWXEANT0z9imGxuUqS4lymFYPIp4S5phEXFTmeXnJxyqPqd6XX1Hu8Hmjvo1kRZSeVRMdCVv0fF8NSW3OLjQzxJVW0MRUs4uNTZOoAJ8M-_JkDi14AB74SUVeZMM6fIQW8VLAPAhkCD73Wlmkih2OBQpjLIJXjJNyXNAmwcjXEpT97rC9v5Bkon9SyDt6TwLPQk3QppggN6tH97datG2WRKcKHs8a_ZjusKsHGfj9MBLfar5xHCZy8db1DeJNJ912ifGu5ZV7F3-5pg5P1IlSJj6eM8EYeJrWWCysBm4vPhsx1jarE09GRpN7e_oI2fiu9z-IlfZB1n8tbuCXDGUvQ9XzlPQbj6PVqZAaxpbAyoLJwFzEAnFCLCKpc_5RMVSt-5CpuH3vPb_hgUmTYS2NQPmnq1m5zEU8n0Q8wlVTVFmOu9UlDp8W2jcZWumf1EBajKR9HezlgHr_T-zJtDw_K-yPx63qDwv0a5m-hpDhimHB707FMJgbLdx_hOL4V1YP8B0b2eIrMYfSTGpT545qNUFr4KewGZpqEmm9ilm0n2rf9_AIXyVxp2Wc3HMIve5YPczE36o3ZNRzgZpnKKXOnl6SYhhrxyRxiHF3zDWd9_guSpyMko5TCs1B3uqmwuVCRKjM_cfsf_8HBCyiMCJzM2b9kod7dYnD8Nv-1mMEPBOd1TG5gs2_u0PimwM9Fg",tag:"hmkF8qyhATtA51z_Yds9IA"}},{id:"did:key:z6Mkn28V7Mk7TyvS82GH5CByFWgBeTbtUedc3HDvJz4bta5f#z6LSnyFDbNfnxgA9MjPwxubimEn2HeDz82kcTgy5XviPUzMU",jwe:{protected:"eyJlbmMiOiJYQzIwUCJ9",recipients:[{header:{kid:"did:key:z6Mkf7FWHfJANm9n4hPMt3dmtAcqnkNuyJLHSovSMnfq4Wws#z6LSpndE8VEdX3kBMMFNnBjvha2ZypXxhBZCfW7qeojX2V6J",alg:"ECDH-ES+A256KW",epk:{kty:"OKP",crv:"X25519",x:"9Pj-5_-MJVVGgGKViDkeCtuIaIhRyzMkq44TqmnQtGs"},apu:"9Pj-5_-MJVVGgGKViDkeCtuIaIhRyzMkq44TqmnQtGs",apv:"ZGlkOmtleTp6Nk1rZjdGV0hmSkFObTluNGhQTXQzZG10QWNxbmtOdXlKTEhTb3ZTTW5mcTRXd3MjejZMU3BuZEU4VkVkWDNrQk1NRk5uQmp2aGEyWnlwWHhoQlpDZlc3cWVvalgyVjZK"},encrypted_key:"OKcgBvtLpraB6GMrxj7W3z_zNGF7wkjAN39OoCktoRgDHcDp_DM1hQ"}],iv:"k6sQp86PHOUzX_WgPLTegu4J8sI7q5ay",ciphertext:"2Ly2TX8jhBP3kx4UzVx3YO-Klz1gK9XJRIQyQonbwdrkgn67iVDP-0kdG7hO3HprQZdI7y0fi9zyWVJ8XDhnBDos0BZ0iK4wOfnZjqEC1c0AC9LqT_9E0up8nx_1I4TEXsfss10k5gNAJW7bgL6QJj6qgdGu3-R1ojjTgc1mIWEdbEeXfEyDvPM8ZB5lOxELPRhGmkPBRw9qoaQWLwZWwX-BptuNMZ4QytZ0bJldXcRostWhdpLBoDb0x1vSu-Rbqh6rnjIn5872E2-r1EgVFiK5j1okUUdJ8cwOdTOz1jrDyqKfSYPGK1_CAStf7qwX34zmgMg8OfJ1uKB0Te3eiHVwvUXZ2mHqHLiZQpIpTOb0dPubJL5u8z5ZpHVbXhITHpKFdKQyoXpII5tP76_SfQWyYRG2MD4bcMuGtbdlzpHffSPf3yTDVboG_sN8Lf8CN2Q3E8NZD2KVs6cqnIKvmqq4Rub_dqX1mkRtrrvBxGys-fcr5gSQ82apEIrSP-Hjd0vz3e3a5iq0t-HcqtsG9DCYTQJrEPNYJCTLHikKXNRZz_KuwxjlAfxmQn-GJ4IByxfRs7qPwA6lTjXsNV8hFFrWJ5SxqnkrzQ-WHxaEAgv43iC0a72WhvtTL4_r7skm-qn2VwC_Y9Zv3kFTJwhrpfkQwNOdrUoipKQpL2CwG7NroQYxrDEBxoQ_t5o7lzVbLGO1faqYlorGS0hDFqeVDyEEuUxtpa_wDmudioBPtkZxPrDBXp_XeIpqZzixEgjeyoz6zZCTpfcCn4PyL70eb75ewYgaE0_Gy047puuNJPJuIV-gXvuOheo0Mq3ikGBKTA",tag:"PSq9qyzsR5PSy8-wr4epxQ"}}]}),Locked=function(){return _ref6};Locked.displayName="Locked",Empty.__docgenInfo={description:"",methods:[],displayName:"Empty"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Example/Example.stories.js"]={name:"Empty",docgenInfo:Empty.__docgenInfo,path:"src/components/Example/Example.stories.js"}),Unlocked.__docgenInfo={description:"",methods:[],displayName:"Unlocked"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Example/Example.stories.js"]={name:"Unlocked",docgenInfo:Unlocked.__docgenInfo,path:"src/components/Example/Example.stories.js"}),Locked.__docgenInfo={description:"",methods:[],displayName:"Locked"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Example/Example.stories.js"]={name:"Locked",docgenInfo:Locked.__docgenInfo,path:"src/components/Example/Example.stories.js"})},230:function(module,exports){},251:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(Buffer){__webpack_require__.d(__webpack_exports__,"a",(function(){return UniversalWallet2020}));var minimal_cipher__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(573),isomorphic_webcrypto__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(314);function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}const _Pact=function(){function _Pact(){}return _Pact.prototype.then=function(onFulfilled,onRejected){const result=new _Pact,state=this.s;if(state){const callback=1&state?onFulfilled:onRejected;if(callback){try{_settle(result,1,callback(this.v))}catch(e){_settle(result,2,e)}return result}return this}return this.o=function(_this){try{const value=_this.v;1&_this.s?_settle(result,1,onFulfilled?onFulfilled(value):value):onRejected?_settle(result,1,onRejected(value)):_settle(result,2,value)}catch(e){_settle(result,2,e)}},result},_Pact}();function _settle(pact,state,value){if(!pact.s){if(value instanceof _Pact){if(!value.s)return void(value.o=_settle.bind(null,pact,state));1&state&&(state=value.s),value=value.v}if(value&&value.then)return void value.then(_settle.bind(null,pact,state),_settle.bind(null,pact,2));pact.s=state,pact.v=value;const observer=pact.o;observer&&observer(pact)}}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var WalletStatus,didKeyDriver=__webpack_require__(821).driver(),resolver_resolve=function resolve(did){try{return Promise.resolve(didKeyDriver.get({did:did}))}catch(e){return Promise.reject(e)}},jsonld=__webpack_require__(1659),documentLoader=function documentLoader(uri){try{var _temp3=function _temp3(_result){return _exit2?_result:function _catch(body,recover){try{var result=body()}catch(e){return recover(e)}return result&&result.then?result.then(void 0,recover):result}((function(){return Promise.resolve(jsonld.documentLoader(uri))}),(function(){console.error("No remote context support for "+uri)}))},_exit2=!1,_temp4=function(){if(0===uri.indexOf("did"))return Promise.resolve(resolver_resolve(uri)).then((function(didDocument){return _exit2=!0,{contextUrl:null,document:didDocument,documentUrl:uri}}))}();return Promise.resolve(_temp4&&_temp4.then?_temp4.then(_temp3):_temp3(_temp4))}catch(e){return Promise.reject(e)}},vcjs=__webpack_require__(1685),Ed25519Signature2018=__webpack_require__(393).suites.Ed25519Signature2018,Ed25519KeyPair=__webpack_require__(197).Ed25519KeyPair,keyToDidDoc=__webpack_require__(821).driver().keyToDidDoc,X25519KeyPair=__webpack_require__(890).X25519KeyPair,passwordToKey=function passwordToKey(password,salt,iterations,digest){void 0===salt&&(salt="salt"),void 0===iterations&&(iterations=1e5),void 0===digest&&(digest="SHA-256");try{var saltBuffer=Buffer.from(salt),passphraseKey=Buffer.from(password);return Promise.resolve(isomorphic_webcrypto__WEBPACK_IMPORTED_MODULE_1__.a.subtle.importKey("raw",passphraseKey,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]).then((function(key){return isomorphic_webcrypto__WEBPACK_IMPORTED_MODULE_1__.a.subtle.deriveKey({name:"PBKDF2",salt:saltBuffer,iterations:iterations,hash:digest},key,{name:"AES-CBC",length:256},!0,["encrypt","decrypt"])})).then((function(webKey){return isomorphic_webcrypto__WEBPACK_IMPORTED_MODULE_1__.a.subtle.exportKey("raw",webKey)})).then((function(buffer){return new Uint8Array(buffer)})))}catch(e){return Promise.reject(e)}},unlockDidKey=function unlockDidKey(seed){try{return Promise.resolve(Ed25519KeyPair.generate({seed:seed})).then((function(ed25519Key){var didDocument=keyToDidDoc(ed25519Key),unlockedDIDDocument=_extends({},didDocument),x25519Key=X25519KeyPair.fromEdKeyPair(ed25519Key);return unlockedDIDDocument.publicKey[0].privateKeyBase58=ed25519Key.privateKeyBase58,unlockedDIDDocument.keyAgreement[0].privateKeyBase58=x25519Key.privateKeyBase58,didDocument}))}catch(e){return Promise.reject(e)}},lockContents=function lockContents(password,contents){try{return Promise.resolve(passwordToKey(password)).then((function(derivedKey){return Promise.resolve(unlockDidKey(derivedKey)).then((function(unlockedDidKey){var lockedDidKey=function lockDidKey(unlockedDIDDocument){return delete unlockedDIDDocument.publicKey[0].privateKeyBase58,delete unlockedDIDDocument.keyAgreement[0].privateKeyBase58,_extends({},unlockedDIDDocument)}(unlockedDidKey),recipients=[{header:{kid:lockedDidKey.keyAgreement[0].id,alg:"ECDH-ES+A256KW"}}],keyResolver=function getKeyResolver(didDocument){var keyAgreementKey=didDocument.keyAgreement[0];return function keyResolver(_ref){var id=_ref.id;if(keyAgreementKey.id===id)return keyAgreementKey;throw new Error("Key "+id+" not found in "+didDocument.id)}}(lockedDidKey),cipher=new minimal_cipher__WEBPACK_IMPORTED_MODULE_0__.a;return Promise.all(contents.map((function(content){return function lockContent(_ref2){var content=_ref2.content,cipher=_ref2.cipher,recipients=_ref2.recipients,keyResolver=_ref2.keyResolver;try{return Promise.resolve(cipher.encryptObject({obj:content,recipients:recipients,keyResolver:keyResolver})).then((function(jwe){return{id:content.id,jwe:jwe}}))}catch(e){return Promise.reject(e)}}({content:_extends({},content),cipher:cipher,recipients:[].concat(recipients),keyResolver:keyResolver})})))}))}))}catch(e){return Promise.reject(e)}},unlockContents=function unlockContents(password,contents){try{return Promise.resolve(passwordToKey(password)).then((function(derivedKey){return Promise.resolve(unlockDidKey(derivedKey)).then((function(unlockedDidKey){var keyAgreementKey=unlockedDidKey.keyAgreement[0],cipher=new minimal_cipher__WEBPACK_IMPORTED_MODULE_0__.a,decryptedContents=[],_temp=function _forTo(array,body,check){var pact,reject,i=-1;return function _cycle(result){try{for(;++i<array.length&&(!check||!check());)if((result=body(i))&&result.then){if(!((thenable=result)instanceof _Pact&&1&thenable.s))return void result.then(_cycle,reject||(reject=_settle.bind(null,pact=new _Pact,2)));result=result.v}pact?_settle(pact,1,result):pact=result}catch(e){_settle(pact||(pact=new _Pact),2,e)}var thenable}(),pact}(contents,(function(i){var content=contents[i];return Promise.resolve(function unlockContent(_ref3){var content=_ref3.content,cipher=_ref3.cipher,keyAgreementKey=_ref3.keyAgreementKey;try{return Promise.resolve(cipher.decryptObject({jwe:content.jwe,keyAgreementKey:new X25519KeyPair(keyAgreementKey)}))}catch(e){return Promise.reject(e)}}({content:content,cipher:cipher,keyAgreementKey:keyAgreementKey})).then((function(decryptedContent){decryptedContents.push(decryptedContent)}))}));return _temp&&_temp.then?_temp.then((function(){return decryptedContents})):decryptedContents}))}))}catch(e){return Promise.reject(e)}},generateDefaultContents=function generateDefaultContents(seed){try{return Promise.resolve(unlockDidKey(seed)).then((function(unlockedDID){return Promise.resolve(function seedToId(seed){try{return Promise.resolve(isomorphic_webcrypto__WEBPACK_IMPORTED_MODULE_1__.a.subtle.digest("SHA-256",seed)).then((function(buffer){return"urn:digest:"+Buffer.from(new Int8Array(buffer)).toString("hex")}))}catch(e){return Promise.reject(e)}}(seed)).then((function(seedId){var secret0={id:seedId,title:"My Entropy",image:"https://via.placeholder.com/150",description:"For testing only.",tags:["inception"],correlation:[seedId],type:"Entropy",seed:Buffer.from(seed).toString("hex")},key0=unlockedDID.publicKey[0];key0=_extends(_extends({},key0),{},{title:"My Signing Key",image:"https://via.placeholder.com/150",description:"Generated from seed.",tags:["inception"],correlation:[seedId],controller:[key0.id]});var key1=unlockedDID.keyAgreement[0];return[secret0,key0,key1=_extends(_extends({},key1),{},{title:"My Encryption Key",image:"https://via.placeholder.com/150",description:"Generated from seed.",tags:["inception"],correlation:[seedId],controller:[key1.id]})]}))}))}catch(e){return Promise.reject(e)}};!function(WalletStatus){WalletStatus.Locked="LOCKED",WalletStatus.Unlocked="UNLOCKED"}(WalletStatus||(WalletStatus={}));var UniversalWallet2020=function(){var UniversalWallet2020=function UniversalWallet2020(contents){var _this2=this,_this3=this,_this4=this,_this5=this,_this=this;void 0===contents&&(contents=[]),this.contents=contents,this.status=WalletStatus.Unlocked,this._expandVerificationMethod=function(options){var results=_this.query((function map(content){return content}),(function reduce(initialValue,item){return item.controller&&item.controller.forEach((function(controller){initialValue[controller]||(initialValue[controller]=item,initialValue[controller].id=controller)})),initialValue}),{}),verificationMethod=options.verificationMethod;if(!results[verificationMethod])throw new Error("Wallet does not contain verificationMethod "+verificationMethod);return options.verificationMethod=results[verificationMethod],options},this.add=function(content){return _this.contents.push(content),content},this.remove=function(contentId){var index=_this.contents.findIndex((function(c){return c.id===contentId})),content=_this.contents[index];return _this.contents=_this.contents.splice(index,index),content},this.lock=function(password){try{return Promise.resolve(lockContents(password,_this2.contents)).then((function(_lockContents){_this2.contents=_lockContents,_this2.status=WalletStatus.Locked}))}catch(e){return Promise.reject(e)}},this.unlock=function(password){try{return Promise.resolve(unlockContents(password,_this3.contents)).then((function(_unlockContents){_this3.contents=_unlockContents,_this3.status=WalletStatus.Unlocked}))}catch(e){return Promise.reject(e)}},this.export=function(controller){if(void 0===controller&&(controller="did:example:123"),_this.status!==WalletStatus.Locked)throw new Error("You cannot export an unlocked wallet.");var encryptedWallet={"@context":["https://www.w3.org/2018/credentials/v1","https://w3id.org/wallet/v1"],id:"http://example.gov/wallet/3732",type:["VerifiableCredential","EncryptedWallet"],issuer:controller,issuanceDate:(new Date).toISOString(),credentialSubject:{id:controller,contents:_this.contents}};return JSON.stringify(encryptedWallet)},this.import=function(encryptedWallet){if(_this.contents.length)throw new Error("You cannot import over existing wallet content.");var parsed=JSON.parse(encryptedWallet);_this.contents=parsed.credentialSubject.contents,_this.status=WalletStatus.Locked},this.query=function(map,reduce,initialValue){if(_this.status!==WalletStatus.Unlocked)throw new Error("You can only query an unlocked wallet.");var results=_this.contents.map(map);return reduce?results.reduce(reduce,initialValue):results},this.issue=function(_ref){var credential=_ref.credential,options=_ref.options;try{var _options=_this4._expandVerificationMethod(options);return Promise.resolve(function issue(_ref4){var credential=_ref4.credential,options=_ref4.options;try{var suite=new Ed25519Signature2018({key:new Ed25519KeyPair(options.verificationMethod)});return Promise.resolve(vcjs.issue({credential:_extends(_extends({},credential),{},{issuer:options.verificationMethod.id.split("#")[0],issuanceDate:credential.issuanceDate||options.created}),suite:suite,documentLoader:documentLoader}))}catch(e){return Promise.reject(e)}}({credential:credential,options:_options}))}catch(e){return Promise.reject(e)}},this.verify=function(_ref2){var credential=_ref2.credential,presentation=_ref2.presentation,options=_ref2.options;try{return credential?Promise.resolve(function verifyCredential(_ref5){var credential=_ref5.credential,suite=new Ed25519Signature2018;return vcjs.verifyCredential({credential:credential,suite:suite,documentLoader:documentLoader})}({credential:credential})):presentation?Promise.resolve(function verifyPresentation(_ref6){var presentation=_ref6.presentation,options=_ref6.options,suite=new Ed25519Signature2018;return vcjs.verify(_extends(_extends({presentation:presentation},options),{},{suite:suite,documentLoader:documentLoader}))}({presentation:presentation,options:options})):Promise.resolve()}catch(e){return Promise.reject(e)}},this.prove=function(_ref3){var verifiableCredential=_ref3.verifiableCredential,options=_ref3.options;try{var _options=_this5._expandVerificationMethod(options);return _options.holder=options.verificationMethod.id.split("#")[0],Promise.resolve(function createVerifiablePresentation(_ref7){var verifiableCredential=_ref7.verifiableCredential,options=_ref7.options,presentation={"@context":["https://www.w3.org/2018/credentials/v1"],type:["VerifiablePresentation"],holder:options.holder,verifiableCredential:verifiableCredential},suite=new Ed25519Signature2018({key:new Ed25519KeyPair(options.verificationMethod)});return vcjs.signPresentation({presentation:presentation,suite:suite,challenge:options.challenge,domain:options.domain})}({verifiableCredential:verifiableCredential,options:_options}))}catch(e){return Promise.reject(e)}},this.status=WalletStatus.Unlocked};return UniversalWallet2020.passwordToSeed=function(password){try{return Promise.resolve(passwordToKey(password))}catch(e){return Promise.reject(e)}},UniversalWallet2020.generate=function(seed){try{return Promise.resolve(generateDefaultContents(seed)).then((function(contents){return new UniversalWallet2020(contents)}))}catch(e){return Promise.reject(e)}},UniversalWallet2020}()}).call(this,__webpack_require__(47).Buffer)},289:function(module,exports){},526:function(module,exports){},531:function(module,exports){},532:function(module,exports){},536:function(module,exports){},553:function(module,exports){},556:function(module,exports){},838:function(module,exports){},882:function(module,exports){},914:function(module,exports,__webpack_require__){__webpack_require__(915),__webpack_require__(1308),module.exports=__webpack_require__(1309)},972:function(module,exports){}},[[914,1,2]]]);
//# sourceMappingURL=main.412e503e62f877b2a1e5.bundle.js.map